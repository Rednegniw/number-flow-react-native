---
title: Hermes Compatibility
description: Intl.NumberFormat polyfill and formatToParts handling
---

React Native uses the Hermes engine by default, which has historically had limited `Intl` support. This page explains how the library handles Hermes-specific quirks.

## Hermes Intl support timeline

| Hermes version | Intl support |
|---|---|
| Pre-2023 | No `Intl.NumberFormat` — requires polyfill |
| 2023–2024 | Basic `Intl.NumberFormat` via ICU, limited `formatToParts` |
| Expo SDK 52+ / RN 0.76+ | Full `Intl` via updated hermes-engine with complete ICU data |

## How the library handles it

### Formatter caching

`getOrCreateFormatter()` maintains a cache of `Intl.NumberFormat` instances keyed by `JSON.stringify([locales, format])`. This avoids creating new formatter instances on every render — `Intl.NumberFormat` construction is expensive (~1ms per instance).

### formatToParts fallback

The core formatting pipeline uses `Intl.NumberFormat.prototype.formatToParts()` to decompose a formatted number into typed parts (integer, decimal, fraction, currency, etc.). Older Hermes versions may not support this method.

The library's `getFormatCharacters()` function extracts the set of characters that can appear in a formatted number — used for glyph measurement. It handles cases where `formatToParts` returns unexpected part types or structures.

### Scientific notation normalization

Scientific and engineering notation (`notation: 'scientific'` / `notation: 'engineering'`) format differently across engines:

- **V8** (Chrome, Node): `6.022E23`
- **Hermes**: May produce `6.022E+23` or other variations

The library's exponent parsing normalizes these differences, extracting the mantissa and exponent parts regardless of the exact format string.

### Number formatting edge cases

Some `Intl.NumberFormat` options behave differently on Hermes:

- **Compact notation** — suffix text (K, M, B) may differ from V8
- **Unit formatting** — `style: 'unit'` support varies by Hermes version
- **Numeral systems** — `numberingSystem` in format options vs locale extension (`-u-nu-arab`) may have different support levels

The library's `detectNumberingSystem()` handles both the format option path and the locale extension path for maximum compatibility.

## Recommendations

- **Expo SDK 52+** / **React Native 0.76+**: Full Intl support, no polyfills needed
- **Older versions**: Consider adding `@formatjs/intl-numberformat` polyfill if you encounter formatting issues
- **Test on device**: Hermes Intl behavior can differ from simulator (especially on older Android)
